\section{Block timestamp}

\subsection{Background}


\paragraph{Yellow Paper}

Miners set the block timestamp during during the mining process (source), in
that process miners have to follow only the restriction of the Ethereum
Yellow-Paper, which is the following:

We define $H_s$ is the timestamp of Block $H$, $P(H)$ is the parent
block of block $H$. The Yellow-Paper defines the following relation for a valid
block timestamp \cite{ethyellowpaper2023}.

\begin{equation} \label{eq:1}
H_s > P(H)_{H_s}
\end{equation}

This definition essentially means the timestamp of the block $H_s$ in
\ref{eq:1} must be greater then the timestamp of the previous (parent) block
$P(H)_{H_s}$.

\paragraph{Software Implementation}

In the implementations of Ethereum, like Geth and Parity there is a
restriction. The timestamp of the new block must at most 15 seconds in the
future \cite{Conkas2021}. \newline

TODO: add sources to the code

\paragraph{Issues}

\begin{itemize}
\item Do not use block.timestamp as time locks, since developer should follow the yellow paper, it is not sure that software implements the restrictions.
\item Do not use block.timestamp as a source of randomness.
\end{itemize}


\paragraph{Do }

\subsection{Examples} 
\begin{solidity} 
    contract TimeLock {
		...
		function lockEth(uint _time, uint _amount) public payable {
			...
			users[msg.sender].unlockBlock = block.number + (_time / 14);
			...
		}

    function withdraw() public {
		...
        require(block.number >= users[msg.sender].unlockBlock, 'lock period not over');
		...
    }
}
\end{solidity}
Source: SWC116 \cite{swc116}